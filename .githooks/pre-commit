#!/usr/bin/env bash
set -euo pipefail

ROOT_DIR="$(git rev-parse --show-toplevel 2>/dev/null || pwd)"
cd "$ROOT_DIR"

case "$(uname -s)" in
  MINGW*|MSYS*|CYGWIN*)
    if [ -x ".venv/Scripts/python.exe" ]; then
      exec ".venv/Scripts/python.exe" -m pre_commit run --hook-stage pre-commit "$@"
    fi
    ;;
  *)
    if [ -x ".venv/bin/python" ]; then
      exec ".venv/bin/python" -m pre_commit run --hook-stage pre-commit "$@"
    fi
    ;;
esac

if command -v pre-commit >/dev/null 2>&1; then
  exec pre-commit run --hook-stage pre-commit "$@"
fi

if command -v python >/dev/null 2>&1; then
  exec python -m pre_commit run --hook-stage pre-commit "$@"
fi

if command -v python3 >/dev/null 2>&1; then
  exec python3 -m pre_commit run --hook-stage pre-commit "$@"
fi

echo "pre-commit is not available. Install it in your environment." >&2
exit 1
